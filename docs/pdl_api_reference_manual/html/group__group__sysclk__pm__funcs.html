<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CAT2 Peripheral Driver Library: Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CAT2 Peripheral Driver Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__group__sysclk__pm__funcs.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Functions<div class="ingroups"><a class="el" href="group__group__sysclk.html">SysClk       (System Clock)</a> &raquo; <a class="el" href="group__group__sysclk__pm.html">Low Power Callback</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga17871ebcd4be248f9b7d3be4399e4909"><td class="memItemLeft" align="right" valign="top">__STATIC_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sysclk__pm__funcs.html#ga17871ebcd4be248f9b7d3be4399e4909">Cy_SysClk_RegisterCallback</a> (<a class="el" href="group__group__sysclk__pm__structs.html#gaf39df020c3cecd6cc7c9d0dc57a1a803">cy_cb_sysclk_t</a> callback, <a class="el" href="structcy__stc__sysclk__context__t.html">cy_stc_sysclk_context_t</a> *context)</td></tr>
<tr class="memdesc:ga17871ebcd4be248f9b7d3be4399e4909"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a callback function that notifies that the timeout occurred in the <a class="el" href="group__group__sysclk__pm__funcs.html#ga34bd0e837cdf7d0953a7e0f5219905b5">Cy_SysClk_DeepSleepCallback</a>.  <a href="#ga17871ebcd4be248f9b7d3be4399e4909">More...</a><br /></td></tr>
<tr class="separator:ga17871ebcd4be248f9b7d3be4399e4909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34bd0e837cdf7d0953a7e0f5219905b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__sysclk__pm__funcs.html#ga34bd0e837cdf7d0953a7e0f5219905b5">Cy_SysClk_DeepSleepCallback</a> (<a class="el" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *callbackParams, <a class="el" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> mode)</td></tr>
<tr class="memdesc:ga34bd0e837cdf7d0953a7e0f5219905b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function to be used when entering system Deep Sleep mode.  <a href="#ga34bd0e837cdf7d0953a7e0f5219905b5">More...</a><br /></td></tr>
<tr class="separator:ga34bd0e837cdf7d0953a7e0f5219905b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga17871ebcd4be248f9b7d3be4399e4909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga17871ebcd4be248f9b7d3be4399e4909">&#9670;&nbsp;</a></span>Cy_SysClk_RegisterCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__STATIC_INLINE void Cy_SysClk_RegisterCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__group__sysclk__pm__structs.html#gaf39df020c3cecd6cc7c9d0dc57a1a803">cy_cb_sysclk_t</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcy__stc__sysclk__context__t.html">cy_stc_sysclk_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a callback function that notifies that the timeout occurred in the <a class="el" href="group__group__sysclk__pm__funcs.html#ga34bd0e837cdf7d0953a7e0f5219905b5">Cy_SysClk_DeepSleepCallback</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>The pointer to a callback function. See <a class="el" href="group__group__sysclk__pm__structs.html#gaf39df020c3cecd6cc7c9d0dc57a1a803">cy_cb_sysclk_t</a> for the function prototype.</td></tr>
    <tr><td class="paramname">context</td><td>The pointer to context structure <a class="el" href="structcy__stc__sysclk__context__t.html">cy_stc_sysclk_context_t</a> allocated by the user. The user should not modify anything in this structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>To remove/unregister the callback, pass NULL as the pointer to the callback function.</dd></dl>
<dl class="section user"><dt>Function Usage</dt><dd><div class="fragment"><div class="line"><span class="comment">/* Scenario: The application uses PLL or ECO as clock sources for HFCLK.</span></div><div class="line"><span class="comment">* The device needs to enter chip Deep Sleep.</span></div><div class="line"><span class="comment">* The ECO and/or PLL should be properly prepared before entering low power mode.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keywordtype">void</span> SysClk_WakeUpTimeOut(uint32_t event)</div><div class="line">{</div><div class="line">    <span class="comment">/* Handle the wake up ECO/PLL error here */</span></div><div class="line">    CY_UNUSED_PARAMETER(event);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__sysclk__context__t.html">cy_stc_sysclk_context_t</a> sysClkContext;</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> sysClkCallbackParams =</div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__stc__syspm__callback__params__t.html#a56076e99358e2b7c99681312108b09af">base</a>       = NULL,</div><div class="line">    .context    = (<span class="keywordtype">void</span>*)&amp;sysClkContext</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> sysClkCallback =</div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__stc__syspm__callback__t.html#afc2210e66cc5a0513e42761df9a2021a">callback</a>       = &amp;<a class="code" href="group__group__sysclk__pm__funcs.html#ga34bd0e837cdf7d0953a7e0f5219905b5">Cy_SysClk_DeepSleepCallback</a>,</div><div class="line">    .type           = <a class="code" href="group__group__syspm__data__enumerates.html#gga8c2960c0164ead1cfa86e7d6846b6ff0abc51d74deff0ceea4304b01b2d57bd9d">CY_SYSPM_DEEPSLEEP</a>,</div><div class="line">    .skipMode       = 0UL,</div><div class="line">    .callbackParams = &amp;sysClkCallbackParams,</div><div class="line">    .prevItm        = NULL,</div><div class="line">    .nextItm        = NULL,</div><div class="line">    .order          = 0</div><div class="line">};</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Function Usage</dt><dd><div class="fragment"><div class="line">    <span class="comment">/* Register all the Deep Sleep callbacks for other peripherals.</span></div><div class="line"><span class="comment">     * The SysClk callback is recommended to be registered last to minimize</span></div><div class="line"><span class="comment">     * the low power mode entry and wake up timings.</span></div><div class="line"><span class="comment">     */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Register the wake up timeout callback */</span></div><div class="line">    <a class="code" href="group__group__sysclk__pm__funcs.html#ga17871ebcd4be248f9b7d3be4399e4909">Cy_SysClk_RegisterCallback</a>(&amp;SysClk_WakeUpTimeOut, &amp;sysClkContext);</div><div class="line"></div><div class="line">    <span class="comment">/* Register the sysClk deep sleep callback */</span></div><div class="line">    <span class="keywordtype">bool</span> regCbStatus = <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;sysClkCallback);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(!regCbStatus)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Could not register callback. Examine the number of registered callbacks */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Ensure that the clock measurement is not running and enter chip Deep Sleep */</span></div></div><!-- fragment --></dd></dl>

</div>
</div>
<a id="ga34bd0e837cdf7d0953a7e0f5219905b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga34bd0e837cdf7d0953a7e0f5219905b5">&#9670;&nbsp;</a></span>Cy_SysClk_DeepSleepCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> Cy_SysClk_DeepSleepCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *&#160;</td>
          <td class="paramname"><em>callbackParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function to be used when entering system Deep Sleep mode. </p>
<p>This function is needed if PLL and/or ECO are enabled and used as a source for HFCLK.</p>
<p>This function performs the following:</p>
<ol type="1">
<li>Before entering Deep Sleep, the clock configuration is saved in SRAM. If the HFCLK is clocked by EXCO (PLL/ECO) - the HFCLK source is changed to IMO (with it current frequency, also IMO is being enabled in case it was disabled).</li>
<li>Upon wakeup from Deep Sleep, the function waits for ECO/PLL stabilization/locking, then restores the clock chain configuration.</li>
<li>It performs unlocking IMO (in case if it was locked with WCO) before falling asleep and correspondingly locks it after waking up (it it was locked before).</li>
<li>It interacts with the ILO calibrating API: the <a class="el" href="group__group__sysclk__ilo__funcs.html#ga84ab8632f6ca5c941e170aa40ff402e4">Cy_SysClk_IloStartMeasurement</a> will not work after the CY_SYSPM_CHECK_READY, or falling asleep will be cancelled in case of the ILO measurement is already in progress.</li>
</ol>
<p>The function prevents entry into Deep Sleep mode if the ILO measurement is currently performing; see <a class="el" href="group__group__sysclk__ilo__funcs.html#ga84ab8632f6ca5c941e170aa40ff402e4">Cy_SysClk_IloStartMeasurement</a>.</p>
<p>This function can be called during execution of <a class="el" href="group__group__syspm__functions__power.html#gae24d1a7d457b5355858651a213c2f4cd">Cy_SysPm_CpuEnterDeepSleep</a>. To do so, register this function as a callback before calling <a class="el" href="group__group__syspm__functions__power.html#gae24d1a7d457b5355858651a213c2f4cd">Cy_SysPm_CpuEnterDeepSleep</a> - specify <a class="el" href="group__group__syspm__data__enumerates.html#gga8c2960c0164ead1cfa86e7d6846b6ff0abc51d74deff0ceea4304b01b2d57bd9d">CY_SYSPM_DEEPSLEEP</a> as the callback type and call <a class="el" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This function is recommended to be the last callback that is registered. Doing so minimizes the time spent on low power mode entry and exit. <br />
Also, after this callback execution before falling asleep and before this callback execution after waking up the HFCLK speed may be not as usual (it is switched to IMO), so it may affect other peripherals. <br />
This function implements all four SysPm callback modes <a class="el" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a>. So the <a class="el" href="structcy__stc__syspm__callback__t.html#a1b49c2454ac29e52261e28eb9071413b">cy_stc_syspm_callback_t::skipMode</a> must be set to 0UL. <br />
You can use this callback implementation as an example to design custom low-power callbacks for certain user application.</dd>
<dd>
There is a non-zero possibility of the ECO/PLL startup timeout at wakeup, therefore there is a user callback feature to indicate that, see <a class="el" href="group__group__sysclk__pm__funcs.html#ga17871ebcd4be248f9b7d3be4399e4909">Cy_SysClk_RegisterCallback</a> and <a class="el" href="group__group__sysclk__pm__events.html">Callback Timeout Events</a>. In case of ECO/PLL timeout, the HFCLK is not restored to the state as it was before the Deep Sleep, so user should either try to reconfigure the HFCLK clocking chain or adapt other periphery to the new HFCLK frequency (reconfigure peripheral clock dividers to restore the communication speed, etc.).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbackParams</td><td>structure with the syspm callback parameters, see <a class="el" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a>.</td></tr>
    <tr><td class="paramname">mode</td><td>Callback mode, see <a class="el" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error / status code; see <a class="el" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a>. Pass if not doing an ILO measurement, otherwise - Fail.</dd></dl>
<dl class="section user"><dt>Function Usage</dt><dd><div class="fragment"><div class="line"><span class="comment">/* Scenario: The application uses PLL or ECO as clock sources for HFCLK.</span></div><div class="line"><span class="comment">* The device needs to enter chip Deep Sleep.</span></div><div class="line"><span class="comment">* The ECO and/or PLL should be properly prepared before entering low power mode.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="keywordtype">void</span> SysClk_WakeUpTimeOut(uint32_t event)</div><div class="line">{</div><div class="line">    <span class="comment">/* Handle the wake up ECO/PLL error here */</span></div><div class="line">    CY_UNUSED_PARAMETER(event);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__sysclk__context__t.html">cy_stc_sysclk_context_t</a> sysClkContext;</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> sysClkCallbackParams =</div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__stc__syspm__callback__params__t.html#a56076e99358e2b7c99681312108b09af">base</a>       = NULL,</div><div class="line">    .context    = (<span class="keywordtype">void</span>*)&amp;sysClkContext</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> sysClkCallback =</div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__stc__syspm__callback__t.html#afc2210e66cc5a0513e42761df9a2021a">callback</a>       = &amp;<a class="code" href="group__group__sysclk__pm__funcs.html#ga34bd0e837cdf7d0953a7e0f5219905b5">Cy_SysClk_DeepSleepCallback</a>,</div><div class="line">    .type           = <a class="code" href="group__group__syspm__data__enumerates.html#gga8c2960c0164ead1cfa86e7d6846b6ff0abc51d74deff0ceea4304b01b2d57bd9d">CY_SYSPM_DEEPSLEEP</a>,</div><div class="line">    .skipMode       = 0UL,</div><div class="line">    .callbackParams = &amp;sysClkCallbackParams,</div><div class="line">    .prevItm        = NULL,</div><div class="line">    .nextItm        = NULL,</div><div class="line">    .order          = 0</div><div class="line">};</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Function Usage</dt><dd><div class="fragment"><div class="line">    <span class="comment">/* Register all the Deep Sleep callbacks for other peripherals.</span></div><div class="line"><span class="comment">     * The SysClk callback is recommended to be registered last to minimize</span></div><div class="line"><span class="comment">     * the low power mode entry and wake up timings.</span></div><div class="line"><span class="comment">     */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Register the wake up timeout callback */</span></div><div class="line">    <a class="code" href="group__group__sysclk__pm__funcs.html#ga17871ebcd4be248f9b7d3be4399e4909">Cy_SysClk_RegisterCallback</a>(&amp;SysClk_WakeUpTimeOut, &amp;sysClkContext);</div><div class="line"></div><div class="line">    <span class="comment">/* Register the sysClk deep sleep callback */</span></div><div class="line">    <span class="keywordtype">bool</span> regCbStatus = <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;sysClkCallback);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(!regCbStatus)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Could not register callback. Examine the number of registered callbacks */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Ensure that the clock measurement is not running and enter chip Deep Sleep */</span></div></div><!-- fragment --></dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>CAT2 Peripheral Driver Library</b> by <b>Infineon Technologies</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
