<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CAT2 Peripheral Driver Library: SysPm        (System Power Management)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CAT2 Peripheral Driver Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__group__syspm.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">API Reference</a>  </div>
  <div class="headertitle">
<div class="title">SysPm (System Power Management)</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<p>Use the System Power Management (SysPm) driver to change power modes and reduce system power consumption in power sensitive designs. </p>
<p>The functions and other declarations used in this driver are in cy_syspm.h. You can include cy_pdl.h to get access to all functions and declarations in the PDL.</p>
<h1><a class="anchor" id="group_syspm_section_configuration"></a>
Configuration Considerations</h1>
<h2><a class="anchor" id="group_syspm_power_modes"></a>
Power Modes</h2>
<p>PSoC 4 MCUs support three CPU power modes. These power modes are intended to minimize average power consumption in an application.</p>
<p>The CPU <b>Active</b>, <b>Sleep</b> and <b>Deep Sleep</b> power modes are Arm-defined power modes supported by the Arm CPU instruction set architecture (ISA).</p>
<h3><a class="anchor" id="group_syspm_switching_into_sleep"></a>
Switching CPU into Sleep</h3>
<p>All pending interrupts must be cleared before the CPU is put into a Sleep mode, even if they are masked.</p>
<h3><a class="anchor" id="group_syspm_switching_into_deepsleep"></a>
Switching into Deep Sleep</h3>
<p>All pending interrupts must be cleared before the system is put into a Deep Sleep mode, even if they are masked.</p>
<h2><a class="anchor" id="group_syspm_wakingup_from_sleep_deepsleep"></a>
Waking Up from Sleep or Deep Sleep</h2>
<p>For Arm-based devices, an interrupt is required for the CPU to wake up.</p>
<h2><a class="anchor" id="group_syspm_cb"></a>
SysPm Callbacks</h2>
<p>The SysPm driver handles low power callbacks declared in the application.</p>
<p>If there are no callbacks registered, the device executes the power mode transition. However, frequently your application firmware must make modifications for low power mode. For example, you may need to disable a peripheral, or ensure that a message is not being transmitted or received.</p>
<p>To enable this, the SysPm driver implements a callback mechanism. When a lower power mode transition is about to take place (either entering or exiting <a class="el" href="group__group__syspm.html#group_syspm_power_modes">Power Modes</a>), the registered callbacks for that transition are called.</p>
<p>The SysPm driver organizes all the callbacks into a linked list. While entering a low power mode, SysPm goes through that linked list from first to last, executing the callbacks one after another. While exiting low power mode, SysPm goes through that linked list again, but in the opposite direction from last to first. This ordering supports prioritization of callbacks relative to the transition event.</p>
<p>For example, the picture below shows three callback structures organized into a linked list: myDeepSleep1, myDeepSleep2, myDeepSleep3 (represented with the <a class="el" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> configuration structure). Each structure contains, among other fields, the address of the callback function. The code snippets below set this up so that myDeepSleep1 is called first when entering the low power mode. This also means that myDeepSleep1 will be the last one to execute when exiting the low power mode.</p>
<p>The callback structures after registration: </p><div class="image">
<img src="syspm_register_eq.png" alt="syspm_register_eq.png"/>
</div>
<p>Your application must register each callback, so that SysPm can execute it. Upon registration, the linked list is built by the SysPm driver. Notice the &amp;myDeepSleep1 address in the myDeepSleep1 <a class="el" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> structure. This is filled in by the SysPm driver, when you register myDeepSleep1. The <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> element defines the order of their execution by the SysPm driver. Call <a class="el" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback()</a> to register each callback function.</p>
<p>A callback function is typically associated with a particular driver that handles the peripheral. So the callback mechanism enables a peripheral to prepare for a low power mode (for instance, shutting down the analog part); or to perform tasks while exiting a low power mode (like enabling the analog part again).</p>
<p>With the callback mechanism you can prevent switching into a low power mode if a peripheral is not ready. For example, driver X is in the process of receiving a message. In the callback function implementation simply return CY_SYSPM_FAIL in a response to CY_SYSPM_CHECK_READY.</p>
<p>If success is returned while executing a callback, the SysPm driver calls the next callback and so on to the end of the list. If at some point a callback returns CY_SYSPM_FAIL in response to the CY_SYSPM_CHECK_READY step, all the callbacks that have already executed are executed in reverse order, with the CY_SYSPM_CHECK_FAIL mode parameter. This allows each callback to know that entering the low power mode has failed. The callback can then undo whatever it did to prepare for low power mode, if required. For example, if the driver X callback shut down the analog part, it can re-enable the analog part.</p>
<p>Let's switch to an example explaining the implementation, setup, and registration of three callbacks (myDeepSleep1, myDeepSleep2, myDeepSleep2) in the application. The <a class="el" href="group__group__syspm.html#group_syspm_cb_config_consideration">Callback Configuration Considerations</a> are provided after the <a class="el" href="group__group__syspm.html#group_syspm_cb_example">SysPm Callbacks Example</a>.</p>
<h2><a class="anchor" id="group_syspm_cb_example"></a>
SysPm Callbacks Example</h2>
<p>The following code snippets demonstrate how use the SysPm callbacks mechanism. We will build the prototype for an application that registers three callback functions:</p><ol type="1">
<li>MyDeepSleepFunc1 - Handles CPU Deep Sleep.</li>
<li>MyDeepSleepFunc2 - Handles CPU Deep Sleep and is associated with peripheral HW1_address.</li>
<li>MyDeepSleepFunc3 - Handles entering and exiting system Deep Sleep and is associated with peripheral HW2_address.</li>
</ol>
<p>We set the myDeepSleep1 and myDeepSleep2 callbacks structures to do nothing while entering the low power mode (skip on CY_SYSPM_SKIP_BEFORE_TRANSITION - see <a class="el" href="group__group__syspm.html#group_syspm_cb_function_implementation">Callback Function Implementation</a> in <a class="el" href="group__group__syspm.html#group_syspm_cb_config_consideration">Callback Configuration Considerations</a>). Skipping the actions while entering low power might be useful if you need to save time while switching low power modes. This is because the callback function with a skipped mode is not even called avoiding the call and return overhead.</p>
<p>Let's first declare the callback functions. Each gets the pointer to the <a class="el" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> structure as the argument.</p>
<div class="fragment"><div class="line"><span class="comment">/* Scenario: There is a need to have three callbacks for the CPU Deep Sleep</span></div><div class="line"><span class="comment">*  mode. MyDeepSleepFunc1 and MyDeepSleepFunc2 callback function skip</span></div><div class="line"><span class="comment">*  CY_SYSPM_BEFORE_TRANSITION mode.</span></div><div class="line"><span class="comment">*  MyDeepSleepFunc3 executes all four modes.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="comment">/******************************************************************************</span></div><div class="line"><span class="comment">*  Callback prototypes</span></div><div class="line"><span class="comment">******************************************************************************/</span></div><div class="line"><a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> MyDeepSleepFunc1(<a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *callbackParams, <a class="code" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> mode);</div><div class="line"><a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> MyDeepSleepFunc2(<a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *callbackParams, <a class="code" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> mode);</div><div class="line"><a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> MyDeepSleepFunc3(<a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *callbackParams, <a class="code" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> mode);</div></div><!-- fragment --><p> Now we setup the <a class="el" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> structures that we will pass to the callback functions. Note that for the MyDeepSleepFunc2 and MyDeepSleepFunc3 callbacks we also pass pointers to the peripherals related to that callback. The configuration considerations related to this structure are described in <a class="el" href="group__group__syspm.html#group_syspm_cb_parameters">Callback Function Parameters</a> in <a class="el" href="group__group__syspm.html#group_syspm_cb_config_consideration">Callback Configuration Considerations</a>.</p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div><div class="line"><span class="comment">*  Parameter structures for callback functions</span></div><div class="line"><span class="comment">******************************************************************************/</span></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> deepSleepParam1 =</div><div class="line">{</div><div class="line">    <span class="comment">/* .base    */</span> NULL,</div><div class="line">    <span class="comment">/* .context */</span> NULL</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> deepSleepParam2 =</div><div class="line">{</div><div class="line">    <span class="comment">/* .base    */</span> &amp;HW1_address,</div><div class="line">    <span class="comment">/* .context */</span> &amp;SysPmContext</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> deepSleepParam3 =</div><div class="line">{</div><div class="line">    <span class="comment">/* .base    */</span> &amp;HW2_address,</div><div class="line">    <span class="comment">/* .context */</span> NULL</div><div class="line">};</div></div><!-- fragment --><p> Now we setup the actual callback configuration structures. Each of these contains, among the other fields, the address of the <a class="el" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> we just set up. We will use the callback configuration structures later in the code to register the callbacks in the SysPm driver. Again, we set things up so that the MyDeepSleepFunc1 and MyDeepSleepFunc2 callbacks do nothing while entering the low power mode (skip on CY_SYSPM_SKIP_BEFORE_TRANSITION) - see <a class="el" href="group__group__syspm.html#group_syspm_cb_function_implementation">Callback Function Implementation</a> in <a class="el" href="group__group__syspm.html#group_syspm_cb_config_consideration">Callback Configuration Considerations</a>.</p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div><div class="line"><span class="comment">*  Callbacks structures</span></div><div class="line"><span class="comment">******************************************************************************/</span></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> myDeepSleep1 =</div><div class="line">{</div><div class="line">    <span class="comment">/* .callback       */</span> &amp;MyDeepSleepFunc1,</div><div class="line">    <span class="comment">/* .type           */</span> <a class="code" href="group__group__syspm__data__enumerates.html#gga8c2960c0164ead1cfa86e7d6846b6ff0abc51d74deff0ceea4304b01b2d57bd9d">CY_SYSPM_DEEPSLEEP</a>,</div><div class="line">    <span class="comment">/* .skipMode       */</span> <a class="code" href="group__group__syspm__skip__callback__modes.html#ga77a2dc7326bb7e6cf893dc7b258b3a42">CY_SYSPM_SKIP_BEFORE_TRANSITION</a>,</div><div class="line">    <span class="comment">/* .callbackParams */</span> &amp;deepSleepParam1,</div><div class="line">    <span class="comment">/* .prevItm        */</span> NULL,</div><div class="line">    <span class="comment">/* .nextItm        */</span> NULL,</div><div class="line">    <span class="comment">/* .order          */</span> 0</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> myDeepSleep2 =</div><div class="line">{</div><div class="line">    <span class="comment">/* .callback       */</span> &amp;MyDeepSleepFunc2,</div><div class="line">    <span class="comment">/* .type           */</span> <a class="code" href="group__group__syspm__data__enumerates.html#gga8c2960c0164ead1cfa86e7d6846b6ff0abc51d74deff0ceea4304b01b2d57bd9d">CY_SYSPM_DEEPSLEEP</a>,</div><div class="line">    <span class="comment">/* .skipMode       */</span> <a class="code" href="group__group__syspm__skip__callback__modes.html#ga77a2dc7326bb7e6cf893dc7b258b3a42">CY_SYSPM_SKIP_BEFORE_TRANSITION</a>,</div><div class="line">    <span class="comment">/* .callbackParams */</span> &amp;deepSleepParam2,</div><div class="line">    <span class="comment">/* .prevItm        */</span> NULL,</div><div class="line">    <span class="comment">/* .nextItm        */</span> NULL,</div><div class="line">    <span class="comment">/* .order          */</span> 0</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> myDeepSleep3 =</div><div class="line">{</div><div class="line">    <span class="comment">/* .callback       */</span> &amp;MyDeepSleepFunc3,</div><div class="line">    <span class="comment">/* .type           */</span> <a class="code" href="group__group__syspm__data__enumerates.html#gga8c2960c0164ead1cfa86e7d6846b6ff0abc51d74deff0ceea4304b01b2d57bd9d">CY_SYSPM_DEEPSLEEP</a>,</div><div class="line">    <span class="comment">/* .skipMode       */</span> 0U,</div><div class="line">    <span class="comment">/* .callbackParams */</span> &amp;deepSleepParam3,</div><div class="line">    <span class="comment">/* .prevItm        */</span> NULL,</div><div class="line">    <span class="comment">/* .nextItm        */</span> NULL,</div><div class="line">    <span class="comment">/* .order          */</span> 0</div><div class="line">};</div><div class="line"></div></div><!-- fragment --><p> Note that in each case the last two fields are NULL. These are fields used by the SysPm driver to set up the linked list of callback functions.</p>
<p>The callback structures are now defined and allocated in the user's memory space: </p><div class="image">
<img src="syspm_before_registration.png" alt="syspm_before_registration.png"/>
</div>
<p>Now we implement the callback functions. See <a class="el" href="group__group__syspm.html#group_syspm_cb_function_implementation">Callback Function Implementation</a> in <a class="el" href="group__group__syspm.html#group_syspm_cb_config_consideration">Callback Configuration Considerations</a> for the instructions on how the callback functions should be implemented.</p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div><div class="line"><span class="comment">*  MyDeepSleepFunc1 implementation</span></div><div class="line"><span class="comment">******************************************************************************/</span></div><div class="line"><a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> MyDeepSleepFunc1(<a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *callbackParams, <a class="code" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> mode)</div><div class="line">{</div><div class="line">    <a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caa5e406c6cb40fdf6663df0208737d4f11">CY_SYSPM_FAIL</a>;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (callbackParams != NULL)</div><div class="line">    {</div><div class="line">        <span class="comment">/* In this use case we do not need to use HW address or context</span></div><div class="line"><span class="comment">        * So, need to add code to some switch case with callbackParams to avoid</span></div><div class="line"><span class="comment">        * compiler warnings</span></div><div class="line"><span class="comment">        */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span>(mode)</div><div class="line">    {</div><div class="line">        <span class="comment">/* In this case ensure that firmware/hardware is ready for CPU</span></div><div class="line"><span class="comment">        *  Deep Sleep mode */</span></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63ab7ec706d80b347433d0063f2a8115784">CY_SYSPM_CHECK_READY</a>:</div><div class="line">            <span class="keywordflow">if</span>(<span class="keyword">true</span><span class="comment">/* system is ready */</span>)</div><div class="line">            {</div><div class="line">                <span class="comment">/* Process the &quot;check ready&quot; condition */</span></div><div class="line">                retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caaf00d22f1ee891a8a56f8bbf58132e775">CY_SYSPM_SUCCESS</a>;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="comment">/* One of the registered callback that was executed after this callback</span></div><div class="line"><span class="comment">        *  returned CY_SYSPM_FAIL, need to revert changes (if any) performed in</span></div><div class="line"><span class="comment">        *  the CY_SYSPM_CHECK_READY case.</span></div><div class="line"><span class="comment">        */</span></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63a96acf2d0ae5537798228d5fba0fecd17">CY_SYSPM_CHECK_FAIL</a>:</div><div class="line">            {</div><div class="line">                <span class="comment">/* Revert changes done in the CY_SYSPM_CHECK_READY case */</span></div><div class="line">                retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caaf00d22f1ee891a8a56f8bbf58132e775">CY_SYSPM_SUCCESS</a>;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="comment">/* This case will be skipped during callbacks execution */</span></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63a7d302375276b3b5f250a8208c999b558">CY_SYSPM_BEFORE_TRANSITION</a>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="comment">/* This case is executed after wakeup from system Deep Sleep */</span></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63aafd1db1f7f86ac7bbd18d59b78af5693">CY_SYSPM_AFTER_TRANSITION</a>:</div><div class="line">            {</div><div class="line">                <span class="comment">/* Perform actions, if required, after wakeup from the</span></div><div class="line"><span class="comment">                *  system Deep Sleep mode */</span></div><div class="line">                retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caaf00d22f1ee891a8a56f8bbf58132e775">CY_SYSPM_SUCCESS</a>;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> (retVal);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/******************************************************************************</span></div><div class="line"><span class="comment">*  MyDeepSleepFunc2 implementation</span></div><div class="line"><span class="comment">******************************************************************************/</span></div><div class="line"><a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> MyDeepSleepFunc2(<a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *callbackParams, <a class="code" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> mode)</div><div class="line">{</div><div class="line">    <a class="code" href="struct_cy_s_c_b___type.html">CySCB_Type</a> *hwBase = (<a class="code" href="struct_cy_s_c_b___type.html">CySCB_Type</a> *) callbackParams-&gt;<a class="code" href="structcy__stc__syspm__callback__params__t.html#a56076e99358e2b7c99681312108b09af">base</a>;</div><div class="line">    <a class="code" href="structcy__stc__scb__spi__context__t.html">cy_stc_scb_spi_context_t</a> *stcPmContext = (<a class="code" href="structcy__stc__scb__spi__context__t.html">cy_stc_scb_spi_context_t</a> *) callbackParams-&gt;<a class="code" href="structcy__stc__syspm__callback__params__t.html#abac771f244791efe23d4964a40bbf8c8">context</a>;</div><div class="line"></div><div class="line">    <a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caa5e406c6cb40fdf6663df0208737d4f11">CY_SYSPM_FAIL</a>;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span>(mode)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Check is the HW1 ready to enter CPU Deep Sleep */</span></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63ab7ec706d80b347433d0063f2a8115784">CY_SYSPM_CHECK_READY</a>:</div><div class="line">        {</div><div class="line">            <span class="comment">/* ... */</span></div><div class="line">            <span class="keywordflow">if</span> (0UL == (<a class="code" href="group__group__scb__spi__macros__xfer__status.html#gab024f7d6ed7cbaa36c80c904a6179de7">CY_SCB_SPI_TRANSFER_ACTIVE</a> &amp; <a class="code" href="group__group__scb__spi__high__level__functions.html#ga95069817e25be749ae989e5d7131f8d0">Cy_SCB_SPI_GetTransferStatus</a>(hwBase, stcPmContext)))</div><div class="line">            {</div><div class="line">                <span class="comment">/* There are no active actions so we can enter CPU Deep Sleep */</span></div><div class="line">                retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caaf00d22f1ee891a8a56f8bbf58132e775">CY_SYSPM_SUCCESS</a>;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caa5e406c6cb40fdf6663df0208737d4f11">CY_SYSPM_FAIL</a>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> (retVal);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/******************************************************************************</span></div><div class="line"><span class="comment">*  MyDeepSleepFunc3 implementation</span></div><div class="line"><span class="comment">******************************************************************************/</span></div><div class="line"><a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> MyDeepSleepFunc3(<a class="code" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> *callbackParams, <a class="code" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> mode)</div><div class="line">{</div><div class="line">    <a class="code" href="struct_cy_s_c_b___type.html">CySCB_Type</a> *hwBase = (<a class="code" href="struct_cy_s_c_b___type.html">CySCB_Type</a> *) callbackParams-&gt;<a class="code" href="structcy__stc__syspm__callback__params__t.html#a56076e99358e2b7c99681312108b09af">base</a>;</div><div class="line"></div><div class="line">    <a class="code" href="group__group__syspm__data__enumerates.html#ga601b1cb722cb091133caf33d8ab235ca">cy_en_syspm_status_t</a> retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caa5e406c6cb40fdf6663df0208737d4f11">CY_SYSPM_FAIL</a>;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span>(mode)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Check is the HW2 ready to enter into CPU Deep Sleep */</span></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63ab7ec706d80b347433d0063f2a8115784">CY_SYSPM_CHECK_READY</a>:</div><div class="line">        {</div><div class="line">            <span class="keywordflow">if</span> (!<a class="code" href="group__group__scb__spi__general__functions.html#ga4241f6166816159f7365220834a5e0d0">Cy_SCB_SPI_IsBusBusy</a>(hwBase))</div><div class="line">            {</div><div class="line">                <span class="comment">/* Process the &quot;check ready&quot; condition */</span></div><div class="line">                retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caaf00d22f1ee891a8a56f8bbf58132e775">CY_SYSPM_SUCCESS</a>;</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63a7d302375276b3b5f250a8208c999b558">CY_SYSPM_BEFORE_TRANSITION</a>:</div><div class="line">        {</div><div class="line">            <span class="comment">/* Switch - Turn off SCB SPI */</span></div><div class="line">            retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caaf00d22f1ee891a8a56f8bbf58132e775">CY_SYSPM_SUCCESS</a>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63aafd1db1f7f86ac7bbd18d59b78af5693">CY_SYSPM_AFTER_TRANSITION</a>:</div><div class="line">        {</div><div class="line">            <span class="comment">/* Switch - Turn on SCB SPI */</span></div><div class="line">            retVal = <a class="code" href="group__group__syspm__data__enumerates.html#gga601b1cb722cb091133caf33d8ab235caaf00d22f1ee891a8a56f8bbf58132e775">CY_SYSPM_SUCCESS</a>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group__group__syspm__data__enumerates.html#ggae06cd8869fe61d709ad6145ca9f3cd63a96acf2d0ae5537798228d5fba0fecd17">CY_SYSPM_CHECK_FAIL</a>:</div><div class="line">        {</div><div class="line">            <span class="comment">/* Revert changes made in CY_SYSPM_CHECK_READY switch case (if any) */</span></div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> (retVal);</div><div class="line">}</div></div><!-- fragment --><p> Finally, we register the callbacks so that the SysPm driver knows about them. The order in which the callbacks will be called depends upon the order in which the callbacks are registered. If there are no callbacks registered, the device just executes the power mode transition, without additional interruptions.</p>
<p>Callbacks that reconfigure global resources, such as clock frequencies, should be registered last. They then modify global resources as the final step before entering the low power mode, and restore those resources first, as the system returns from low power mode.</p>
<div class="fragment"><div class="line">    <span class="comment">/* Register myDeepSleep1 */</span></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span> != <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;myDeepSleep1))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Register myDeepSleep2 */</span></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span> != <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;myDeepSleep2))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Register myDeepSleep3 */</span></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span> != <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;myDeepSleep3))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div></div><!-- fragment --><p> We are done configuring three callbacks. Now the SysPm driver will execute the callbacks appropriately whenever there is a call to a power mode transition function: <a class="el" href="group__group__syspm__functions__power.html#ga614227f50da974213b141e860f8a4527">Cy_SysPm_CpuEnterSleep()</a>, <a class="el" href="group__group__syspm__functions__power.html#gae24d1a7d457b5355858651a213c2f4cd">Cy_SysPm_CpuEnterDeepSleep()</a>.</p>
<p>Refer to <a class="el" href="group__group__syspm.html#group_syspm_cb_unregistering">Callback Unregistering</a> in <a class="el" href="group__group__syspm.html#group_syspm_cb_config_consideration">Callback Configuration Considerations</a> to learn what to do if you need to remove the callback from the linked list. You might want to unregister the callback for debug purposes.</p>
<p>Refer to <a class="el" href="group__group__syspm.html#group_syspm_cb_flow">Callbacks Execution Flow</a> in <a class="el" href="group__group__syspm.html#group_syspm_cb_config_consideration">Callback Configuration Considerations</a> to learn about how the SysPm processes the callbacks.</p>
<h2><a class="anchor" id="group_syspm_cb_config_consideration"></a>
Callback Configuration Considerations</h2>
<h3><a class="anchor" id="group_syspm_cb_parameters"></a>
Callback Function Parameters</h3>
<p>The <b>callbackParams</b> parameter of the callback function is a <a class="el" href="structcy__stc__syspm__callback__params__t.html">cy_stc_syspm_callback_params_t</a> structure. The second parameter (<b>mode</b>) is for internal use. In the example code we used a dummy value CY_SYSPM_CHECK_READY to eliminate compilation errors associated with the enumeration. The driver sets the <b>mode</b> field to the correct value when calling the callback functions (the mode is referred to as step in the <a class="el" href="group__group__syspm.html#group_syspm_cb_function_implementation">Callback Function Implementation</a>). The callback function reads the value and executes code based on the mode set by the SysPm driver. The <b>base</b> and <b>context</b> fields are optional and can be NULL. Some drivers require a base hardware address and context to store information about the mode transition. If your callback routine requires access to the driver registers or context, provide those values. Be aware of MISRA warnings if these parameters are NULL.</p>
<h3><a class="anchor" id="group_syspm_cb_structures"></a>
Callback Function Structure</h3>
<p>For each callback, provide a <a class="el" href="structcy__stc__syspm__callback__t.html">cy_stc_syspm_callback_t</a> structure. Some fields in this structure are maintained by the driver. Use NULL for <a class="el" href="structcy__stc__syspm__callback__t.html#ac4dd0cc8f5d4e92eefae3d10df920a56" title="The previous list item. ">cy_stc_syspm_callback_t.prevItm</a> and <a class="el" href="structcy__stc__syspm__callback__t.html#a491e913ae8b54d0a61f2ac6959abf8ab" title="The next list item. ">cy_stc_syspm_callback_t.nextItm</a>. Driver uses these fields to build a linked list of callback functions. The value of <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> element is used to define the order how the callbacks are put into linked list, and sequentially, how the callbacks are executed. See <a class="el" href="group__group__syspm.html#group_syspm_cb_registering">Callback Registering</a> section.</p>
<dl class="section warning"><dt>Warning</dt><dd>The <a class="el" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7" title="Registers a new syspm callback. ">Cy_SysPm_RegisterCallback()</a> function stores a pointer to the <a class="el" href="structcy__stc__syspm__callback__t.html" title="Structure with syspm callback configuration elements. ">cy_stc_syspm_callback_t</a> structure. Do not modify elements of the <a class="el" href="structcy__stc__syspm__callback__t.html" title="Structure with syspm callback configuration elements. ">cy_stc_syspm_callback_t</a> structure after the callback is registered. You are responsible for ensuring that the structure remains in scope. Typically the structure is declared as a global or static variable, or as a local variable in the main() function.</dd></dl>
<h3><a class="anchor" id="group_syspm_cb_function_implementation"></a>
Callback Function Implementation</h3>
<p>Every callback function should handle four possible steps (referred to as "mode") defined in <a class="el" href="group__group__syspm__data__enumerates.html#gae06cd8869fe61d709ad6145ca9f3cd63">cy_en_syspm_callback_mode_t</a> :</p><ul>
<li>CY_SYSPM_CHECK_READY - Check if ready to enter a power mode.</li>
<li>CY_SYSPM_BEFORE_TRANSITION - The actions to be done before entering the low power mode.</li>
<li>CY_SYSPM_AFTER_TRANSITION - The actions to be done after exiting the low power mode.</li>
<li>CY_SYSPM_CHECK_FAIL - Roll back any actions performed in the callback executed previously with CY_SYSPM_CHECK_READY.</li>
</ul>
<p>A callback function can skip steps (see <a class="el" href="group__group__syspm__skip__callback__modes.html">Defines to skip the callbacks modes</a>). In our example myDeepSleep1 and myDeepSleep2 callbacks do nothing while entering the low power mode (skip on CY_SYSPM_BEFORE_TRANSITION). If there is anything preventing low power mode entry - return CY_SYSPM_FAIL in response to CY_SYSPM_CHECK_READY in your callback implementation. Note that the callback should return CY_SYSPM_FAIL only in response to CY_SYSPM_CHECK_READY. The callback function should always return CY_SYSPM_PASS for other modes: CY_SYSPM_CHECK_FAIL, CY_SYSPM_BEFORE_TRANSITION, and CY_SYSPM_AFTER_TRANSITION (see <a class="el" href="group__group__syspm.html#group_syspm_cb_flow">Callbacks Execution Flow</a>).</p>
<h3><a class="anchor" id="group_syspm_cb_flow"></a>
Callbacks Execution Flow</h3>
<p>This section explains what happens during a power transition, when callbacks are implemented and set up correctly. The following discussion assumes:</p><ul>
<li>All required callback functions are defined and implemented</li>
<li>All <a class="el" href="structcy__stc__syspm__callback__t.html" title="Structure with syspm callback configuration elements. ">cy_stc_syspm_callback_t</a> structures are filled with required values</li>
<li>All callbacks are successfully registered</li>
</ul>
<p>User calls <a class="el" href="group__group__syspm__functions__power.html#ga614227f50da974213b141e860f8a4527">Cy_SysPm_CpuEnterSleep()</a> or <a class="el" href="group__group__syspm__functions__power.html#gae24d1a7d457b5355858651a213c2f4cd">Cy_SysPm_CpuEnterDeepSleep()</a>. It calls each callback with the mode set to CY_SYSPM_CHECK_READY. This triggers execution of the code for that mode inside of each user callback.</p>
<p>The intent of CY_SYSPM_CHECK_READY is to only signal if the resources is ready to transition. Ideally, no transition changes should be made at this time. In some cases a small change may be required. For example a communication resource callback may set a flag telling firmware not to start any new transition.</p>
<p>If that process is successful for all callbacks, then <a class="el" href="group__group__syspm__functions__callback.html#ga95462119281ba8dec6b313f85dd752b0">Cy_SysPm_ExecuteCallback()</a> calls each callback with the mode set to CY_SYSPM_BEFORE_TRANSITION. This triggers execution of the code for that mode inside each user callback. We then enter the low power mode after all callback are executed.</p>
<p>When exiting the low power mode, the SysPm driver executes <a class="el" href="group__group__syspm__functions__callback.html#ga95462119281ba8dec6b313f85dd752b0">Cy_SysPm_ExecuteCallback()</a> again. This time it calls each callback in reverse order, with the mode set to CY_SYSPM_AFTER_TRANSITION. This triggers execution of the code for that mode inside each user callback.</p>
<p>A callback can return CY_SYSPM_FAIL only while executing the CY_SYSPM_CHECK_READY mode. If that happens, then the remaining callbacks are not executed. Any callbacks that have already executed are called again, in reverse order, with CY_SYSPM_CHECK_FAIL. This allows the system to return to the previous state. If a callback returns a fail then any of the functions (<a class="el" href="group__group__syspm__functions__power.html#ga614227f50da974213b141e860f8a4527">Cy_SysPm_CpuEnterSleep()</a>, <a class="el" href="group__group__syspm__functions__power.html#gae24d1a7d457b5355858651a213c2f4cd">Cy_SysPm_CpuEnterDeepSleep()</a>) that attempt to switch the device into a low power mode will also return CY_SYSPM_FAIL.</p>
<p>Callbacks that reconfigure global resources, such as clock frequencies, should be registered last. They then modify global resources as the final step before entering the low power mode, and restore those resources first, as the system returns from low power mode.</p>
<h3><a class="anchor" id="group_syspm_cb_registering"></a>
Callback Registering</h3>
<p>While registration the callback is put into the linked list. The place where the callback structure is put into the linked list is based on <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a>. The callback with the lowest <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> value will be placed at the beginning of linked list. The callback with the highest <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> value will be placed at the end of the linked list. If there is already a callback structure in the linked list with the same <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> value as you attend to register, then your callback will be placed right after such a callback.</p>
<p>Such a registration order defines how the callbacks are executed:</p><ul>
<li>Callbacks with the lower <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> are executed first when entering into low power and last when exiting from low power.</li>
<li>Callbacks with the higher <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> are executed last when entering into low power and first when exiting from low power.</li>
</ul>
<div class="fragment"><div class="line">    <span class="comment">/* Register myDeepSleep1 */</span></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span> != <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;myDeepSleep1))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Register myDeepSleep2 */</span></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span> != <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;myDeepSleep2))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Register myDeepSleep3 */</span></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span> != <a class="code" href="group__group__syspm__functions__callback.html#ga0d58b00c8dc764a6371590f70e2f73c7">Cy_SysPm_RegisterCallback</a>(&amp;myDeepSleep3))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handling */</span></div><div class="line">    }</div></div><!-- fragment --><p> Callbacks with equal <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> values are registered in the same order as they are registered: </p><div class="image">
<img src="syspm_register_eq.png" alt="syspm_register_eq.png"/>
</div>
<p>Callbacks with a different <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> value will be stored based on the <a class="el" href="structcy__stc__syspm__callback__t.html#a13e6dfd81747d61783aac9ca28931fe4" title="Holds the callback execution order value. ">cy_stc_syspm_callback_t.order</a> value, with no matter when they when registered:</p>
<div class="image">
<img src="syspm_register_dif.png" alt="syspm_register_dif.png"/>
</div>
<p>This can be useful to ensure that system resources (clock dividers, etc) are changed right before entering low power mode and immediately after exiting from low power.</p>
<h3><a class="anchor" id="group_syspm_cb_unregistering"></a>
Callback Unregistering</h3>
<p>Unregistering the callback might be useful when you need to dynamically manage the callbacks.</p>
<div class="fragment"><div class="line">    <span class="comment">/* Scenario: There is a need to unregister a previously registered callback */</span></div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">true</span> != <a class="code" href="group__group__syspm__functions__callback.html#gab7b9b923fceff2f37a6b8288253b0e82">Cy_SysPm_UnregisterCallback</a>(&amp;myDeepSleep2))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Insert error handler */</span></div><div class="line">    }</div></div><!-- fragment --><p>The callback structures after myDeepSleep2 callback is unregistered: </p><div class="image">
<img src="syspm_unregistration.png" alt="syspm_unregistration.png"/>
</div>
<h1><a class="anchor" id="group_syspm_section_more_information"></a>
More Information</h1>
<p>For more information on the SysPm driver, refer to the technical reference manual (TRM).</p>
<h1><a class="anchor" id="group_syspm_changelog"></a>
Changelog</h1>
<table class="doxtable">
<tr>
<th>Version</th><th>Changes</th><th>Reason for Change </th></tr>
<tr>
<td rowspan="2">3.0 </td><td>Added <a class="el" href="group__group__syspm__functions__power.html#ga0dbfb8d55476773c9daf64186c561857">Cy_SysPm_CpuEnterSleepNoCallbacks()</a> and <a class="el" href="group__group__syspm__functions__power.html#ga16a9b6a228c1453d50b009c29ef9af83">Cy_SysPm_CpuEnterDeepSleepNoCallbacks()</a>. Alternative to <a class="el" href="group__group__syspm__functions__power.html#ga614227f50da974213b141e860f8a4527">Cy_SysPm_CpuEnterSleep()</a> and <a class="el" href="group__group__syspm__functions__power.html#gae24d1a7d457b5355858651a213c2f4cd">Cy_SysPm_CpuEnterDeepSleep()</a> but without execution of registered callbacks. The newly added functions can be used for minimization of flash memory consumption and/or speed-up of the Low-power mode entry/exit. The application is responsible for preparing a device for entering Low-power mode and restoring its state on a wakeup.  </td><td>Flash memory consumption optimization  </td></tr>
<tr>
<td>Removed unused status macros. </td><td>Code cleanup.  </td></tr>
<tr>
<td>2.10.1 </td><td>Update the paths to the code snippets. </td><td>PDL structure update.  </td></tr>
<tr>
<td>2.10 </td><td>Corrected the size of the internal callback array to match the number of the supported low power modes. </td><td>Implementation enhancement.  </td></tr>
<tr>
<td>2.0 </td><td><a class="el" href="group__group__syspm__functions__power.html#gae24d1a7d457b5355858651a213c2f4cd">Cy_SysPm_CpuEnterDeepSleep</a> is changed so that the <a class="el" href="group__group__sysclk__pm__funcs.html#ga34bd0e837cdf7d0953a7e0f5219905b5">Cy_SysClk_DeepSleepCallback</a> registration is needed. The clock tree manipulation code is removed. </td><td>SysClk enhancement, see <a class="el" href="group__group__sysclk__pm.html">Low Power Callback</a>  </td></tr>
<tr>
<td>1.0 </td><td>Initial version </td><td></td></tr>
</table>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
API Reference</h2></td></tr>
<tr class="memitem:group__group__syspm__macros"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__syspm__macros.html">Macros</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__syspm__functions"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__syspm__functions.html">Functions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__syspm__data__structures"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__syspm__data__structures.html">Data Structures</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__syspm__data__enumerates"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__syspm__data__enumerates.html">Enumerated Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>CAT2 Peripheral Driver Library</b> by <b>Infineon Technologies</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
